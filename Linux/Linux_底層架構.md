# Linux 底層架構

Linux 是一個基於 Unix 的操作系統，並且它的設計遵循了 Unix 的許多核心概念。Linux 的底層架構由多個組件構成，這些組件協同工作來提供多任務處理、多用戶支持以及高效的資源管理。以下是 Linux 系統底層架構的主要組件及其功能：

## 1. **硬體（Hardware）**

- Linux 操作系統運行在實際的硬體之上，包括 CPU、記憶體（RAM）、硬碟、網路接口卡、顯示卡等。
- 硬體層是最底層的結構，Linux 依賴內核與硬體的交互來執行各種操作，如記憶體管理、設備控制等。

## 2. **Linux 內核（Kernel）**

- 內核是 Linux 系統的核心，負責與硬體交互、資源分配、進程調度、文件系統管理等。它是操作系統和硬體之 間的橋樑，實現了操作系統的基本功能。
- 內核可以分為幾個主要部分：

  ### 1. **進程管理（Process Management）**

  - Linux 支持多進程和多任務，並且對每個進程進行管理，進行進程調度、同步、通信等操作。內核負責決定哪些進程獲得 CPU 資源，何時調度它們執行。

  ### 2. **內存管理（Memory Management）**

  - Linux 使用虛擬內存技術來管理物理內存。每個進程都有自己的虛擬地址空間，內核負責將這些虛擬地址映射到物理內存。
  - Linux 也支持內存分頁、交換（swap）等功能，以提高內存使用效率。

  ### 3. **設備驅動（Device Drivers）**

  - 內核包含了大量的設備驅動程序，這些驅動程序幫助操作系統與硬體設備進行通信。硬體設備（如硬碟、顯示卡、網卡等）通過相應的設備驅動被內核識別並控制。

  ### 4. **文件系統（File System）**

  - Linux 提供了多種文件系統支持，如 ext4、xfs、btrfs 等。文件系統負責組織、存儲和管理數據，並且提供檔案存取、權限控制等功能。
  - 所有的硬碟、設備和目錄都以統一的文件系統結構進行管理。

  ### 5. **系統調用（System Calls）**

  - 系統調用是內核與用戶空間之間的接口，允許用戶程序訪問內核服務（如文件操作、進程管理、網路通信等）。Linux 提供了一系列的系統調用 API，讓應用程式能夠執行需要內核支持的操作。

## 3. **用戶空間（User Space）**

- 用戶空間是用戶與操作系統互動的地方，它包括所有的應用程序、命令、庫文件等。用戶空間與內核空間是分開的，這樣可以保護內核不會受到用戶應用程序的直接影響。

  ### 1. **Shell**

  - Shell 是用戶與內核交互的接口，它是一個命令行解釋器，允許用戶輸入命令並執行系統操作。常見的 Shell 有 **Bash**、**Zsh**、**Fish** 等。

  ### 2. **用戶程序（User Programs）**

  - 用戶程序是運行在用戶空間中的應用程序，這些程序不直接與硬體互動，而是通過系統調用來請求內核提供的服務。用戶程序包括文本編輯器、瀏覽器、辦公套件等應用。

  ### 3. **庫文件（Libraries）**

  - 庫文件（如 C 標準庫 `glibc`）提供了一些用於開發應用程序的常用函數和 API。這些庫封裝了內核提供的系統調用，並為應用程序提供更高級的功能。

  ### 4. **命令行工具（Command-Line Tools）**

  - Linux 提供了大量的命令行工具，用於文件管理、進程管理、網路配置、系統監控等。這些工具通常運行在用戶空間，並通過內核調用來完成操作。

## 4. **系統服務與守護進程（System Services & Daemons）**

- Linux 系統運行許多守護進程（Daemon），這些進程在系統啟動時自動啟動並持續運行，提供不同的系統服務（如網路服務、打印服務、日志管理等）。
- 常見的守護進程有：
  - `systemd`：現代 Linux 系統的初始化系統和服務管理器。
  - `sshd`：提供 SSH 服務，允許遠程登錄。
  - `cron`：定時任務調度器，用於定期執行任務。

## 5. **用戶與權限管理（User and Permission Management）**

- Linux 是一個多用戶系統，所有操作都需要基於用戶和權限來進行管理。用戶可以擁有不同的權限（如讀、寫、執行），並且不同用戶之間的操作是隔離的。
- Linux 使用 **文件權限**、**用戶組**、**擁有者** 和 **sudo** 等機制來控制對系統資源的訪問。
- 常見的用戶管理命令有：
  - `useradd`：新增用戶。
  - `usermod`：修改用戶信息。
  - `chmod`：改變文件權限。
  - `chown`：改變文件擁有者。

## 6. **內核模塊（Kernel Modules）**

- Linux 內核支持動態加載和卸載模塊。內核模塊是內核的可插拔組件，允許用戶在不重啟系統的情況下添加或移除功能。
- 內核模塊通常用於設備驅動、文件系統、網路協議等。

- 用戶可以使用以下命令來管理內核模塊：
  - `lsmod`：列出當前加載的模塊。
  - `modprobe`：加載或卸載內核模塊。
  - `insmod`：插入內核模塊。
  - `rmmod`：移除內核模塊。

## 7. **硬體抽象層（Hardware Abstraction Layer, HAL）**

- 在某些 Linux 發行版中，**硬體抽象層**（HAL）用於在內核和硬體之間提供一個中介層，這使得內核能夠以統一的方式與不同的硬體設備進行交互。
